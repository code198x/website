---
// Specific layout for blog post pages
// import Layout from './Layout.astro'; <-- No longer needed directly
import ArticleLayout from './ArticleLayout.astro'; // Import the new base article layout
import type { CollectionEntry } from 'astro:content';
// import PostNavigation from '../components/PostNavigation.astro'; // Handled by ArticleLayout

// Updated structure for related posts passed as props
interface RelatedItem {
  slug: string;
  title: string;
  collection: string; // Added collection
}

interface Props {
	entry: CollectionEntry<'posts'>; // Expects a blog post entry
  prev: { slug: string; title: string } | null;
  next: { slug: string; title: string } | null;
  relatedPosts?: RelatedItem[]; // Use updated interface
}

const { entry, prev, next, relatedPosts } = Astro.props; // Destructure relatedPosts
const { title, description, publishDate, tags } = entry.data;
const contentType = 'blog'; // Define content type for navigation
---
<ArticleLayout 
  title={title}
  contentType={contentType}
  prev={prev}
  next={next}
  relatedPosts={relatedPosts} // Pass relatedPosts down
  pageTitle={`${title} - Blog - Code 198x`}
  prevText="&larr; Previous Post"
  nextText="Next Post &rarr;"
>
  {/* Blog post metadata goes into the 'metadata-below-title' slot */}
  <Fragment slot="metadata-below-title">
    <p class="publish-date">Published on: 
      <time datetime={publishDate.toISOString()}>
        {publishDate.toLocaleDateString('en-us', {
          year: 'numeric',
          month: 'short',
          day: 'numeric',
        })}
      </time>
    </p>
    {tags && tags.length > 0 && <p class="tags">Tags: {tags.join(', ')}</p>}
  </Fragment>

	<slot /> {/* Blog post content goes into the default slot */}

</ArticleLayout>

{/* Styles specific to BlogLayout can remain */}
<style>
  /* Remove styles handled by ArticleLayout or base Layout.astro */
	/* Keep styles specific only to blog posts, e.g., metadata formatting */
	.publish-date, .tags {
		margin-bottom: 0.25em; /* Tighter spacing for metadata */
    font-size: 0.9em;
    color: var(--color-text-muted); /* Example: Muted color */
	}
  .tags {
    margin-top: 0; /* Remove potential top margin if needed */
  }
</style> 